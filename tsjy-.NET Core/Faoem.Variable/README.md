# Faoem.Variable

## 项目简介

处理变量相关功能。

## 功能

- 获取连接器状态
- 获取变量数据
- 获取归档变量
- 添加归档变量
- 更新归档变量
- 删除归档变

## 已知问题

### 删除归档变量时，有时会导致遗留一条已归档的历史记录。

原因：

使用了变量替代每次变量变化或归档任务执行时都查询数据库。

删除归档变量的流程为：

1. 删除归档变量
2. 删除归档变量的历史记录
3. 保存数据库
4. 刷新归档变量数据变量

如果在第 2 步结束后到第 4 步完成前触发了归档任务，则会产生一条呆滞的归档记录。

边缘设备最多连接 3000 条变量，创建 6000 个归档任务，如果每个任务遗留一条数据，那么最多会有 6000 条遗留数据。

6000 条遗留数据至多会减少不足 2 小时的数据归档存储时间（按照每秒归档，2 小时会产生 7200 条归档数据）。

目前，用于归档的时序数据库数据保留时间默认为 30 天，30 天后遗留数据会被自动清理。

**影响较小，暂不处理**
